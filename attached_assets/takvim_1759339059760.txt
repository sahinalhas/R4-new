================================================================================
TAKVÄ°M SÄ°STEMÄ° - DETAYLI DÃ–KÃœMANTASYON
================================================================================

Ä°Ã‡Ä°NDEKÄ°LER:
1. TAKVÄ°M SÄ°STEMÄ°NÄ°N DETAYLI AÃ‡IKLAMASI
2. GELÄ°ÅTÄ°RME Ã–NERÄ°LERÄ°
3. GELÄ°ÅTÄ°RME KOMUTLARI (YAPAY ZEKA Ä°Ã‡Ä°N)

================================================================================
BÃ–LÃœM 1: TAKVÄ°M SÄ°STEMÄ°NÄ°N DETAYLI AÃ‡IKLAMASI
================================================================================

GENEL YAPI
----------

Programda **iki tane takvim sistemi** var ve bunlar birbiriyle entegre Ã§alÄ±ÅŸÄ±yor:

1. **TAKVÄ°M 1** - HaftalÄ±k Ders Ã‡izelgesi (WeeklySchedule)
2. **TAKVÄ°M 2** - Konu BazlÄ± Plan (TopicPlanner)

================================================================================
TAKVÄ°M 1: HAFTALIK DERS Ã‡Ä°ZELGESÄ° (WeeklySchedule)
================================================================================

GÃ–RÃœNÃœM VE ARAYÃœZ
-----------------

Ãœst KÄ±sÄ±m (Header):
- **BaÅŸlÄ±k**: "HaftalÄ±k Ders Ã‡izelgesi"
- **Alt baÅŸlÄ±k**: "Takvim 1 â€” Ãœstten dersi sÃ¼rÃ¼kleyip gÃ¼n/saat alanÄ±na bÄ±rakÄ±n"

Filtre ButonlarÄ±:
[TÃ¼mÃ¼] [LGS] [TYT] [AYT] [YDT]
- Bu butonlarla dersler kategoriye gÃ¶re filtreleniyor
- Aktif buton koyu renk (default variant), diÄŸerleri aÃ§Ä±k renk (outline variant)

Ders Badge'leri (SÃ¼rÃ¼klenebilir):
- Her ders bir badge ÅŸeklinde gÃ¶steriliyor
- Format: "Ders AdÄ± (Kategori)"
- Ã–rnek: "Matematik (TYT)", "Fizik (AYT)"
- Badge'ler sÃ¼rÃ¼klenebilir (draggable)
- Cursor: grab (tutma iÅŸareti)

Takvim Grid YapÄ±sÄ±:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Saat   â”‚ Pzt     â”‚ SalÄ±    â”‚ Ã‡rÅŸ     â”‚ PrÅŸ     â”‚ Cuma    â”‚ Cmt     â”‚ Pazar   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 07:00  â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”‚ 07:30  â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”‚ 08:00  â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â”‚   ...  â”‚   ...   â”‚   ...   â”‚   ...   â”‚   ...   â”‚   ...   â”‚   ...   â”‚   ...   â”‚
â”‚ 23:30  â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Grid Ã–zellikleri:
- Grid sÃ¼tun yapÄ±sÄ±: `72px repeat(7, minmax(60px, 1fr))`
- Ä°lk sÃ¼tun 72px (saat gÃ¶sterimi iÃ§in)
- 7 gÃ¼n sÃ¼tunu, her biri minimum 60px, eÅŸit geniÅŸlikte
- SatÄ±r yÃ¼ksekliÄŸi: 28px (ROW_H = 28)
- Toplam satÄ±r sayÄ±sÄ±: 34 (ROWS = 34)

Zaman Parametreleri:
- BaÅŸlangÄ±Ã§: 07:00 (START_MIN = 7 * 60 = 420 dakika)
- BitiÅŸ: 24:00 (END_MIN = 24 * 60 = 1440 dakika)
- AdÄ±m: 30 dakika (STEP = 30)
- SatÄ±r sayÄ±sÄ±: (1440 - 420) / 30 = 34 satÄ±r

Saat GÃ¶sterimi:
- Sadece tam saatler gÃ¶steriliyor (07:00, 08:00, 09:00 vb.)
- Saat etiketleri: text-[11px], saÄŸ tarafta, dikey ortalanmÄ±ÅŸ

Ders BloklarÄ± (Slot):

GÃ¶rsel Ã–zellikler:
- Arka plan: bg-primary/15 (aÃ§Ä±k renk, yarÄ± ÅŸeffaf)
- KenarlÄ±k: border border-primary/30
- YuvarlatÄ±lmÄ±ÅŸ kÃ¶ÅŸeler: rounded
- Blur efekti: backdrop-blur
- Ä°Ã§erik padding: p-2 pr-8
- Sol/saÄŸ boÅŸluk: left-2 right-2

Ders BloÄŸu Ä°Ã§eriÄŸi:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Matematik (TYT)            [X]    â”‚
â”‚ 09:00 - 10:30                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

- Ãœst satÄ±r: Ders adÄ± ve kategori (font-medium, truncate)
- Alt satÄ±r: BaÅŸlangÄ±Ã§ - BitiÅŸ saati (text-[11px], text-muted-foreground)
- SaÄŸ Ã¼st kÃ¶ÅŸe: Silme butonu (Trash2 ikonu, 7x7px)

Resize Handle'larÄ± (BoyutlandÄ±rma TutacaklarÄ±):

Ãœst kenar:
- YÃ¼kseklik: 8px (h-2)
- Cursor: n-resize (yukarÄ±-aÅŸaÄŸÄ± ok)
- Tooltip: "Ãœstten sÃ¼rÃ¼kleyerek kÄ±salt/uzat (30dk)"

Alt kenar:
- YÃ¼kseklik: 8px (h-2)
- Cursor: s-resize (yukarÄ±-aÅŸaÄŸÄ± ok)
- Tooltip: "Alttan sÃ¼rÃ¼kleyerek kÄ±salt/uzat (30dk)"

Alt Bilgi Ã‡ubuÄŸu:
HaftalÄ±k toplam: 24.5 saat

- Toplam Ã§alÄ±ÅŸma sÃ¼resini gÃ¶sterir
- UyarÄ±lar:
  - 5 saatten az: "Ã‡alÄ±ÅŸma sÃ¼ren Ã§ok dÃ¼ÅŸÃ¼k!" (amber-600)
  - 10 saatten fazla: "Plan Ã§ok yoÄŸun!" (red-600)

Ä°ÅLEVSELLÄ°K VE ETKÄ°LEÅÄ°MLER
----------------------------

1. DERS EKLEME (Drag & Drop):

AdÄ±mlar:
1. KullanÄ±cÄ± Ã¼stteki badge'lerden birini tutar (onDragStart)
2. Grid Ã¼zerinde bir hÃ¼creye sÃ¼rÃ¼kler
3. HÃ¼crenin Ã¼zerine geldiÄŸinde hover efekti (hover:bg-muted/30)
4. BÄ±rakÄ±r (onDrop)

Kod AkÄ±ÅŸÄ±:
- onDragStart: subjectId kaydedilir (window._dragSubjectId)
- dropOn(day, startMin): 
  - VarsayÄ±lan sÃ¼re: 60 dakika
  - Ã‡akÄ±ÅŸma kontrolÃ¼ (overlaps fonksiyonu)
  - Ã‡akÄ±ÅŸma varsa: "Bu saatte baÅŸka bir ders var!" hatasÄ±
  - Ã‡akÄ±ÅŸma yoksa: addWeeklySlot(yeni slot)

Veri YapÄ±sÄ± (WeeklySlot):
{
  id: string,              // UUID
  studentId: string,       // Ã–ÄŸrenci ID
  day: 1|2|3|4|5|6|7,     // GÃ¼n (1=Pzt, 7=Paz)
  start: "HH:MM",         // BaÅŸlangÄ±Ã§ saati
  end: "HH:MM",           // BitiÅŸ saati
  subjectId: string       // Ders ID
}

2. DERS TAÅIMA (Move):

AdÄ±mlar:
1. KullanÄ±cÄ± mevcut ders bloÄŸunu tutar
2. FarklÄ± bir gÃ¼n/saate sÃ¼rÃ¼kler
3. BÄ±rakÄ±r

Kod AkÄ±ÅŸÄ±:
- onDragStart: "move-slot:{id}" kaydedilir
- dropOn: 
  - window._dragSlotMove'dan id ve duration alÄ±nÄ±r
  - Yeni pozisyonda Ã§akÄ±ÅŸma kontrolÃ¼
  - updateWeeklySlot(id, yeni day/start/end)

3. BOYUTLANDIRMA (Resize):

Ãœstten boyutlandÄ±rma:
- Pointer down â†’ resizingRef set edilir (edge: "top")
- Pointer move â†’ deltaRows hesaplanÄ±r (dy / ROW_H)
- newStart = origStart + (deltaRows * 30dk)
- updateWeeklySlot anÄ±nda uygulanÄ±r

Alttan boyutlandÄ±rma:
- AynÄ± mantÄ±k, edge: "bottom"
- newEnd = origEnd + (deltaRows * 30dk)

SÄ±nÄ±rlamalar:
- Minimum sÃ¼re: 30 dakika (STEP)
- Ã‡akÄ±ÅŸan dersler arasÄ±nda sÄ±nÄ±r
- Saat aralÄ±ÄŸÄ±: 07:00 - 24:00

4. DERS SÄ°LME:
- SaÄŸ Ã¼st kÃ¶ÅŸedeki Trash2 ikonuna tÄ±klama
- removeWeeklySlot(id) Ã§aÄŸrÄ±lÄ±r
- Slot listeden silinir, UI gÃ¼ncellenir

VERÄ° KATMANI (Backend & Storage)
---------------------------------

Frontend API FonksiyonlarÄ±:
- loadWeeklySlots(): WeeklySlot[]
- getWeeklySlotsByStudent(studentId): WeeklySlot[]
- addWeeklySlot(slot): Promise<void>
- removeWeeklySlot(id): Promise<void>
- updateWeeklySlot(id, patch): Promise<void>
- saveWeeklySlots(slots): Promise<void>

Backend API Endpoints:
GET  /api/weekly-slots          // TÃ¼m slotlarÄ± getir
GET  /api/weekly-slots/:studentId  // Ã–ÄŸrenciye gÃ¶re
POST /api/weekly-slots          // Yeni slot ekle
PUT  /api/weekly-slots/:id      // Slot gÃ¼ncelle
DELETE /api/weekly-slots/:id    // Slot sil

VeritabanÄ± Tablosu:
CREATE TABLE weekly_slots (
  id TEXT PRIMARY KEY,
  studentId TEXT NOT NULL,
  day INTEGER NOT NULL,      -- 1-7
  startTime TEXT NOT NULL,   -- "HH:MM"
  endTime TEXT NOT NULL,     -- "HH:MM"
  subjectId TEXT NOT NULL
)

Caching & GÃ¼ncelleme:
- Frontend'de weeklySlotsCache deÄŸiÅŸkeni
- Her deÄŸiÅŸiklikte window.dispatchEvent('weeklySlotsUpdated')
- Components bu eventi dinler ve yeniden render olur

================================================================================
TAKVÄ°M 2: KONU BAZLI PLAN (TopicPlanner)
================================================================================

GÃ–RÃœNÃœM VE ARAYÃœZ
-----------------

Ãœst KÄ±sÄ±m:
- **BaÅŸlÄ±k**: "Konu BazlÄ± Plan"
- **Alt baÅŸlÄ±k**: "Takvim 2 â€” Konular, Takvim 1 ders bloklarÄ±na sÄ±rayla yerleÅŸtirilir"

Kontrol Paneli:
[Tarih SeÃ§ici (input type="date")] [PlanÄ± Uygula]

- Tarih seÃ§ici: Hafta baÅŸlangÄ±cÄ± (Pazartesi) otomatik hesaplanÄ±r
- "PlanÄ± Uygula" butonu: Plan uygulandÄ±ÄŸÄ±nda progress gÃ¼ncellenir

Legend (Renk GÃ¶stergesi):
â— TYT    â— AYT    â— YDT

- TYT: bg-primary (mavi)
- AYT: bg-accent (turuncu/farklÄ± renk)
- YDT: bg-amber-500 (sarÄ±)

GÃœNLÃœK LÄ°STE GÃ–RÃœNÃœMÃœ
---------------------

Her gÃ¼n iÃ§in ayrÄ± bir bÃ¶lÃ¼m:

Pazartesi â€” 2025-01-06                    Toplam: 180 dk
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [09:00-10:30] Matematik (TYT) â€” Limit ve SÃ¼reklilik  â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ (60%)                        â”‚
â”‚ Kalan: 36 dk                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [10:30-11:30] Fizik (AYT) â€” Newton YasalarÄ±          â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ (45%)                        â”‚
â”‚ Kalan: 55 dk                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Konu KartÄ± Ã–zellikleri:

Arka plan renkleri:
- TYT: bg-primary/10 border-primary/30
- AYT: bg-accent/10 border-accent/30
- YDT: bg-amber-500/10 border-amber-500/30

Ä°Ã§erik:
1. Saat aralÄ±ÄŸÄ± badge: [09:00-10:30]
2. Ders adÄ± ve konu: "Matematik (TYT) â€” Limit ve SÃ¼reklilik"
3. SÃ¼re: "90 dk"
4. Progress bar: YÃ¼kseklik 1.5, bg-muted + bg-primary
5. Kalan sÃ¼re: "Kalan: 36 dk"

KONU DURUMLARI BÃ–LÃœMÃœ
---------------------

Altta tÃ¼m konularÄ±n ilerlemesi:

Konu DurumlarÄ±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Matematik] Limit ve SÃ¼reklilik  54/90 dk [SÄ±fÄ±rla] â”‚
â”‚ [Fizik] Newton YasalarÄ±          45/100 dk [SÄ±fÄ±rla] â”‚
â”‚ [Kimya] Asit-Baz                 80/80 dk [SÄ±fÄ±rla]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ä°ÅLEVSELLÄ°K - PLANLAMA ALGORITMASI
-----------------------------------

planWeek Fonksiyonu:
Bu fonksiyon **TAKVÄ°M 1'deki haftalÄ±k slotlarÄ±** alÄ±r ve **konularÄ±** sÄ±rayla yerleÅŸtirir.

Algoritma AdÄ±mlarÄ±:

1. HazÄ±rlÄ±k:
   - Ã–ÄŸrencinin tÃ¼m konularÄ±nÄ± yÃ¼kle (loadTopics)
   - Her konunun progress bilgisini al (getProgressByStudent)
   - HaftalÄ±k slotlarÄ± gÃ¼n ve saate gÃ¶re sÄ±rala

2. KonularÄ± derslere gÃ¶re grupla:
   - topicsBySubject Map'i oluÅŸtur
   - Her ders iÃ§in konularÄ± order'a gÃ¶re sÄ±rala

3. Her slot iÃ§in:
   for (slot in weeklySlots) {
     slotSÃ¼resi = slot.end - slot.start (dakika)
     
     while (slotSÃ¼resi > 0) {
       - Bu ders iÃ§in sonraki tamamlanmamÄ±ÅŸ konuyu bul (pickNext)
       - EÄŸer konu yoksa, dÃ¶ngÃ¼den Ã§Ä±k
       
       - allocated = min(slotSÃ¼resi, konuKalan)
       - Plana ekle: {
           date, start, end, subjectId, topicId, 
           allocated, remainingAfter
         }
       
       - Konu progress'ini gÃ¼ncelle (in-memory)
       - slotSÃ¼resi -= allocated
       - Slot iÃ§indeki cursor'Ä± ilerlet (currentStartMin += allocated)
     }
   }

4. Ã–rnek Senaryo:
   Slot: Pazartesi 09:00-11:00 (120dk), Matematik (TYT)
   
   Matematik konularÄ±:
   1. Limit (kalan: 90dk)
   2. TÃ¼rev (kalan: 150dk)
   
   Plan:
   - 09:00-10:30: Limit (90dk) â†’ Limit tamamlandÄ±
   - 10:30-11:00: TÃ¼rev (30dk) â†’ TÃ¼rev'de 120dk kaldÄ±

Veri YapÄ±sÄ± (PlannedEntry):
{
  date: "2025-01-06",        // YYYY-MM-DD
  start: "09:00",            // HH:MM
  end: "10:30",              // HH:MM
  subjectId: "math-tyt-123",
  topicId: "limit-456",
  allocated: 90,             // dakika
  remainingAfter: 0          // dakika
}

PlanÄ± Uygula (applyPlan):
async function applyPlan() {
  for (entry of plan) {
    await updateProgress(
      studentId, 
      entry.topicId, 
      entry.allocated
    )
  }
  // Progress updated, UI refreshes
}

VERÄ° KATMANI
------------

Subjects (Dersler):
{
  id: string,
  name: string,          // "Matematik"
  category: "TYT"|"AYT"|"YDT"|"LGS",
  code?: string,
  description?: string,
  color?: string
}

Topics (Konular):
{
  id: string,
  subjectId: string,     // Hangi derse ait
  name: string,          // "Limit ve SÃ¼reklilik"
  avgMinutes: number,    // Ortalama Ã§alÄ±ÅŸma sÃ¼resi (dk)
  estimatedHours?: number,
  difficulty?: string,
  order?: number,        // SÄ±ralama
  description?: string
}

TopicProgress (Ä°lerleme):
{
  id: string,
  studentId: string,
  topicId: string,
  completed: number,     // Tamamlanan dakika
  remaining: number,     // Kalan dakika
  completedFlag?: boolean,  // Manuel tamamlanma
  lastStudied?: string,
  notes?: string
}

API Endpoints:
GET  /api/subjects         // TÃ¼m dersleri getir
POST /api/subjects         // Dersleri kaydet
GET  /api/topics          // TÃ¼m konularÄ± getir
POST /api/topics          // KonularÄ± kaydet
GET  /api/progress        // TÃ¼m progress'leri getir
POST /api/progress        // Progress kaydet

TAKVÄ°MLER ARASI Ä°LÄ°ÅKÄ°
-----------------------

Ã‡alÄ±ÅŸma AkÄ±ÅŸÄ±:

1. KullanÄ±cÄ± TAKVÄ°M 1'de haftalÄ±k programa dersler ekler:
   - Ã–rnek: Pazartesi 09:00-11:00 Matematik (TYT)
   - Ã–rnek: SalÄ± 14:00-15:30 Fizik (AYT)

2. Konular sistemde tanÄ±mlÄ±:
   - Matematik altÄ±nda: Limit (90dk), TÃ¼rev (150dk), Ä°ntegral (120dk)
   - Fizik altÄ±nda: Newton (100dk), Enerji (80dk)

3. TAKVÄ°M 2 otomatik olarak planÄ± oluÅŸturur:
   - HaftalÄ±k slotlarÄ± alÄ±r
   - Her slot iÃ§in o dersin konularÄ±nÄ± sÄ±rayla yerleÅŸtirir
   - Konu sÃ¼releri ve progress'e gÃ¶re daÄŸÄ±tÄ±m yapar

4. KullanÄ±cÄ± "PlanÄ± Uygula" derse:
   - Her konunun progress'i gÃ¼ncellenir
   - Completed artÄ±rÄ±lÄ±r, remaining azalÄ±r
   - Konu tamamlandÄ±ysa completedFlag = true

Otomatik GÃ¼ncellemeler:

// Event listeners
window.addEventListener('weeklySlotsUpdated', handleUpdate)
window.addEventListener('subjectsUpdated', handleUpdate)
window.addEventListener('topicsUpdated', handleUpdate)
window.addEventListener('progressUpdated', handleUpdate)

- WeeklySlots deÄŸiÅŸince â†’ TAKVÄ°M 2 planÄ± yeniden hesaplar
- Topics deÄŸiÅŸince â†’ Plan yeniden oluÅŸturulur
- Progress gÃ¼ncellenince â†’ Konu durumlarÄ± ve progress bar'lar gÃ¼ncellenir

TEKNÄ°K DETAYLAR
---------------

Grid HesaplamalarÄ±:

// Saat â†’ Dakika
function toMin(t: "HH:MM"): number {
  const [h, m] = t.split(":").map(Number)
  return h * 60 + m
}

// Dakika â†’ Saat
function fmt(mins: number): "HH:MM" {
  const h = Math.floor(mins / 60)
  const mm = mins % 60
  return `${h.toString().padStart(2,'0')}:${mm.toString().padStart(2,'0')}`
}

// Pixel â†’ Row index
rowIndex = (minutes - START_MIN) / STEP

// Row â†’ Pixel position
top = rowIndex * ROW_H
height = (endMin - startMin) / STEP * ROW_H

Ã‡akÄ±ÅŸma KontrolÃ¼:

function overlaps(a: WeeklySlot, b: WeeklySlot): boolean {
  if (a.day !== b.day) return false
  
  const s1 = toMin(a.start), e1 = toMin(a.end)
  const s2 = toMin(b.start), e2 = toMin(b.end)
  
  // KesiÅŸim varsa true
  return Math.max(s1, s2) < Math.min(e1, e2)
}

Resize MantÄ±ÄŸÄ±:

onPointerMove(event) {
  const dy = event.clientY - startY
  const deltaRows = Math.round(dy / ROW_H)
  
  if (edge === "top") {
    newStart = origStart + (deltaRows * STEP)
    newStart = clamp(newStart, minStart, origEnd - STEP)
  } else {
    newEnd = origEnd + (deltaRows * STEP)
    newEnd = clamp(newEnd, origStart + STEP, maxEnd)
  }
  
  updateWeeklySlot(id, { start: fmt(newStart), end: fmt(newEnd) })
}

STYLING VE TAILWIND CLASS'LARI
-------------------------------

Grid Container:
className="w-full overflow-auto rounded border"

Header Row:
className="p-2 text-xs font-medium border-b bg-muted/40"

Time Cell:
style={{ height: ROW_H }}
className="border-t border-l last:border-r hover:bg-muted/30 transition-colors"

Slot Card:
className="absolute left-2 right-2 rounded bg-primary/15 border border-primary/30 text-xs p-2 pr-8 flex items-center gap-2 backdrop-blur pointer-events-auto cursor-move"

Progress Bar:
// Container
className="mt-2 h-1.5 w-full rounded bg-muted overflow-hidden"

// Fill
className="h-full bg-primary"
style={{ width: `${percentage}%` }}

Ã–NEMLÄ° NOTLAR
-------------

1. 30 dakikalÄ±k adÄ±mlar: TÃ¼m ders ekleme/boyutlandÄ±rma 30dk'lÄ±k bloklarda
2. Otomatik hizalama: Resize sÄ±rasÄ±nda snap-to-grid davranÄ±ÅŸÄ±
3. Ã‡akÄ±ÅŸma Ã¶nleme: AynÄ± gÃ¼n/saatte iki ders olamaz
4. SÄ±ralÄ± planlama: Konular order deÄŸerine gÃ¶re sÄ±rayla iÅŸlenir
5. Progress takibi: Her konu iÃ§in ayrÄ± ilerleme kaydÄ±
6. Responsive: Grid mobil cihazlarda scroll edilebilir
7. Real-time sync: API deÄŸiÅŸiklikleri anÄ±nda UI'da yansÄ±r

================================================================================
BÃ–LÃœM 2: GELÄ°ÅTÄ°RME Ã–NERÄ°LERÄ°
================================================================================

KRÄ°TÄ°K GELÄ°ÅTÄ°RME ALANLARI
---------------------------

1. AKILLI PLANLAMA ALGORÄ°TMASI

Mevcut durum: Konular sadece order deÄŸerine gÃ¶re sÄ±rayla iÅŸleniyor.

GeliÅŸtirme Ã¶nerileri:
- Ã–ncelik sistemi: Konulara aciliyet/Ã¶nem skoru ekle (Ã¶rn: sÄ±nav tarihi yakÄ±n konular Ã¶nce)
- Zorluk bazlÄ± daÄŸÄ±lÄ±m: Zor konularÄ± zihin taze iken (sabah), kolay konularÄ± yorgun saatlere yerleÅŸtir
- Spaced Repetition: Unutma eÄŸrisine gÃ¶re konularÄ±n tekrarÄ±nÄ± planla (Ebbinghaus eÄŸrisi)
- Dinamik sÃ¼re ayarÄ±: Konunun zorluÄŸuna gÃ¶re sÃ¼releri otomatik ayarla

2. Ã‡AKIÅMA YÃ–NETÄ°MÄ°

Mevcut durum: Ã‡akÄ±ÅŸma olunca sadece hata veriyor.

GeliÅŸtirme Ã¶nerileri:
- Otomatik kaydÄ±rma: Ã‡akÄ±ÅŸan dersi en yakÄ±n boÅŸ alana otomatik yerleÅŸtir
- Swap Ã¶nerisi: "Bu saatte X dersi var, deÄŸiÅŸtirmek ister misin?" diye sor
- AkÄ±llÄ± bÃ¶lme: Uzun dersi bÃ¶lerek boÅŸluklara yerleÅŸtir
- Ã–neri sistemi: En uygun boÅŸ saatleri highlight et

3. BOÅLUK OPTÄ°MÄ°ZASYONU

Mevcut durum: Slotlarda kalan sÃ¼re kullanÄ±lmÄ±yor.

GeliÅŸtirme Ã¶nerileri:
- KÄ±sa konular: 15-30dk'lÄ±k mini konular tanÄ±mla (tekrar, Ã¶zet, soru Ã§Ã¶zme)
- BoÅŸluk doldurma: "10 dakika kaldÄ±, hÄ±zlÄ± tekrar yapmak ister misin?" Ã¶ner
- Molalar: 50dk ders + 10dk mola gibi otomatik mola ekleme

4. PROGRESS TAKÄ°BÄ°

Mevcut durum: Sadece dakika bazlÄ± ilerleme.

GeliÅŸtirme Ã¶nerileri:
- Kalite metriÄŸi: "Konuyu ne kadar anladÄ±n? (1-5)" gibi self-assessment
- Test entegrasyonu: Konudan sonra mini quiz, baÅŸarÄ± oranÄ±na gÃ¶re "Tekrar gerek" iÅŸaretle
- GÃ¶rselleÅŸtirme: HaftalÄ±k/aylÄ±k ilerleme grafikleri
- Hedef tracking: "Bu konuyu bitirmek iÃ§in 3 gÃ¼n kaldÄ±" gibi uyarÄ±lar

5. ESNEKLÄ°K & KULLANICI DENEYÄ°MÄ°

Mevcut durum: KatÄ± yapÄ±, esneklik yok.

GeliÅŸtirme Ã¶nerileri:
- Drag to swap: Dersleri direkt sÃ¼rÃ¼kleyerek yer deÄŸiÅŸtir
- Toplu iÅŸlemler: TÃ¼m haftayÄ± kopyala/yapÄ±ÅŸtÄ±r
- Template sistem: "LGS HazÄ±rlÄ±k", "YKS Son 3 Ay" gibi hazÄ±r programlar
- Undo/Redo: Son 10 iÅŸlemi geri al/tekrarla
- Multi-select: Birden fazla dersi seÃ§ip toplu taÅŸÄ±/sil

6. GERÃ‡EKÃ‡Ä° PLANLAMA

Mevcut durum: TÃ¼m slotlar kullanÄ±lÄ±yor, ama gerÃ§ek hayatta bu olmaz.

GeliÅŸtirme Ã¶nerileri:
- Verimlilik faktÃ¶rÃ¼: "Slotun %80'i aktif kullanÄ±lÄ±r" gibi gerÃ§ekÃ§i hesaplama
- Yorgunluk modeli: GÃ¼nde 8+ saat planlandÄ±ysa uyar, verimlilik dÃ¼ÅŸer
- DeÄŸiÅŸken tempo: Hafta iÃ§i yoÄŸun, hafta sonu gevÅŸek program yapabilme
- Buffer time: Slotlar arasÄ± 5-10dk geÃ§iÅŸ sÃ¼resi ekle

7. VERÄ° GÃ–RSELLEÅTÄ°RME (TAKVÄ°M 2)

Mevcut durum: Sadece liste gÃ¶rÃ¼nÃ¼mÃ¼.

GeliÅŸtirme Ã¶nerileri:
- Grid gÃ¶rÃ¼nÃ¼m: TAKVÄ°M 1 gibi grid'de konu bloklarÄ±nÄ± gÃ¶ster (ÅŸu an kod var ama kullanÄ±lmÄ±yor - WeeklyTopicGrid)
- Gantt chart: KonularÄ±n zaman Ã§izelgesi
- Heat map: Hangi gÃ¼nler daha yoÄŸun, renklerle gÃ¶ster
- Ä°statistikler: "Bu hafta en Ã§ok Matematik Ã§alÄ±ÅŸtÄ±n (6.5 saat)"

8. BÄ°LDÄ°RÄ°M & HATIRLATMA

Mevcut durum: Yok.

GeliÅŸtirme Ã¶nerileri:
- PlanlÄ± bildirim: "15dk sonra Fizik dersin baÅŸlÄ±yor"
- Motivasyon: "3 gÃ¼n Ã¼st Ã¼ste plan uyguladÄ±n, harikasÄ±n! ğŸ‰"
- UyarÄ±lar: "Bu hafta hiÃ§ Kimya Ã§alÄ±ÅŸmadÄ±n"

9. Ã‡OKLU Ã–ÄRENCÄ° & SENKRONÄ°ZASYON

Mevcut durum: Her Ã¶ÄŸrencinin ayrÄ± planÄ± var ama karÅŸÄ±laÅŸtÄ±rma yok.

GeliÅŸtirme Ã¶nerileri:
- KarÅŸÄ±laÅŸtÄ±rma: Ã–ÄŸrenciler arasÄ± ilerleme kÄ±yaslamasÄ±
- Grup planÄ±: EtÃ¼t saatleri gibi toplu planlar
- Mentor sistemi: Rehber Ã¶ÄŸretmen tÃ¼m Ã¶ÄŸrencileri tek ekranda gÃ¶rebilsin

10. PERFORMANS & TEKNÄ°K

Mevcut durum: Her deÄŸiÅŸiklikte API call, render heavy.

GeliÅŸtirme Ã¶nerileri:
- Debouncing: Resize sÄ±rasÄ±nda sÃ¼rekli API call yerine bitiÅŸ anÄ±nda kaydet
- Optimistic UI: API beklemeden UI'Ä± gÃ¼ncelle, hata olursa geri al
- Virtual scrolling: Uzun listeler iÃ§in
- Local draft: DeÄŸiÅŸiklikleri local'de tut, "Kaydet" butonuna basÄ±nca senkronize et

Ã–NCELÄ°KLENDÄ°RME
---------------

HÄ±zlÄ± KazanÄ±mlar (1-2 gÃ¼n):
1. Otomatik boÅŸluk kaydÄ±rma (Ã§akÄ±ÅŸma yÃ¶netimi)
2. Undo/Redo
3. Template sistem
4. Progress quality tracking

Orta Vadeli (1 hafta):
1. Spaced repetition algoritmasÄ±
2. AkÄ±llÄ± planlama (zorluk/Ã¶ncelik bazlÄ±)
3. Grid gÃ¶rÃ¼nÃ¼m aktifleÅŸtirme
4. Bildirimler

Uzun Vadeli (2+ hafta):
1. AI destekli Ã¶neriler
2. Test entegrasyonu
3. DetaylÄ± analitik/raporlama

================================================================================
BÃ–LÃœM 3: GELÄ°ÅTÄ°RME KOMUTLARI (YAPAY ZEKA Ä°Ã‡Ä°N)
================================================================================

AÅŸaÄŸÄ±daki her bÃ¶lÃ¼m, yapay zekaya verebileceÄŸiniz **tam komut formatÄ±nda** yazÄ±lmÄ±ÅŸtÄ±r.

--------------------------------------------------------------------------------
1. AKILLI Ã‡AKIÅMA YÃ–NETÄ°MÄ°
--------------------------------------------------------------------------------

KOMUT:

TAKVÄ°M 1 (WeeklySchedule) sistemine akÄ±llÄ± Ã§akÄ±ÅŸma yÃ¶netimi ekle:

MEVCUT DURUM:
- Ã‡akÄ±ÅŸma olunca sadece "Bu saatte baÅŸka bir ders var!" hatasÄ± gÃ¶steriliyor
- KullanÄ±cÄ± manuel olarak baÅŸka bir saat bulmalÄ±

YENÄ° Ä°STENEN Ã–ZELLÄ°KLER:

1. OTOMATIK KAYDIRMA:
   - Ã‡akÄ±ÅŸma tespit edilince, en yakÄ±n boÅŸ hÃ¼creyi otomatik bul
   - KullanÄ±cÄ±ya sor: "Bu saatte X dersi var. [En yakÄ±n boÅŸ saat: 14:30] Otomatik yerleÅŸtir?"
   - EÄŸer kabul ederse, otomatik o saate yerleÅŸtir
   
2. SWAP (DEÄÄ°ÅTÄ°R) Ã–NERÄ°SÄ°:
   - "Bu saatte Matematik var. DeÄŸiÅŸtirmek ister misin?" dialog gÃ¶ster
   - Evet derse: Ä°ki dersi yer deÄŸiÅŸtir
   - HayÄ±r derse: Ä°ptal et

3. GÃ–RSEL Ä°YÄ°LEÅTÄ°RME:
   - SÃ¼rÃ¼klerken Ã§akÄ±ÅŸan hÃ¼creleri kÄ±rmÄ±zÄ± highlight et
   - BoÅŸ hÃ¼creleri yeÅŸil highlight et
   - En uygun 3 boÅŸ hÃ¼creyi parlat (pulse animasyonu)

UYGULAMA:

A) dropOn fonksiyonunu gÃ¼ncelle:
```javascript
const dropOn = (day, startMin) => {
  setError("");
  const candidate = createSlotCandidate(day, startMin);
  
  // Ã‡akÄ±ÅŸma kontrolÃ¼
  const conflicting = slots.find(s => overlaps(s, candidate));
  
  if (conflicting) {
    // En yakÄ±n boÅŸ saati bul
    const nearestSlot = findNearestEmptySlot(day, startMin, candidate.duration);
    
    if (nearestSlot) {
      // Dialog gÃ¶ster
      showConflictDialog({
        conflictingSlot: conflicting,
        suggestedSlot: nearestSlot,
        onAutoPlace: () => dropOn(nearestSlot.day, nearestSlot.startMin),
        onSwap: () => swapSlots(candidate, conflicting),
        onCancel: () => setError("Ä°ÅŸlem iptal edildi")
      });
    } else {
      setError("Bu saatte baÅŸka bir ders var ve boÅŸ saat bulunamadÄ±!");
    }
    return;
  }
  
  // Ã‡akÄ±ÅŸma yoksa normal ekle
  addWeeklySlot(candidate);
};
```

B) Yeni fonksiyonlar ekle:
```javascript
// En yakÄ±n boÅŸ slot bul
function findNearestEmptySlot(targetDay, targetMin, duration) {
  const allSlots = [];
  
  // AynÄ± gÃ¼n Ã¶nce kontrol et
  for (let min = START_MIN; min < END_MIN - duration; min += STEP) {
    if (isSlotEmpty(targetDay, min, duration)) {
      allSlots.push({
        day: targetDay,
        startMin: min,
        distance: Math.abs(min - targetMin)
      });
    }
  }
  
  // DiÄŸer gÃ¼nleri kontrol et
  for (let day = 1; day <= 7; day++) {
    if (day === targetDay) continue;
    for (let min = START_MIN; min < END_MIN - duration; min += STEP) {
      if (isSlotEmpty(day, min, duration)) {
        allSlots.push({
          day,
          startMin: min,
          distance: Math.abs(min - targetMin) + (Math.abs(day - targetDay) * 1440)
        });
      }
    }
  }
  
  // En yakÄ±nÄ± dÃ¶ndÃ¼r
  return allSlots.sort((a, b) => a.distance - b.distance)[0];
}

// Slot boÅŸ mu kontrol et
function isSlotEmpty(day, startMin, duration) {
  const testSlot = {
    day,
    start: fmt(startMin),
    end: fmt(startMin + duration)
  };
  return !slots.some(s => overlaps(s, testSlot));
}

// Ä°ki slotu yer deÄŸiÅŸtir
function swapSlots(newSlot, existingSlot) {
  const tempDay = existingSlot.day;
  const tempStart = existingSlot.start;
  const tempEnd = existingSlot.end;
  
  updateWeeklySlot(existingSlot.id, {
    day: newSlot.day,
    start: newSlot.start,
    end: newSlot.end
  });
  
  addWeeklySlot({
    ...newSlot,
    day: tempDay,
    start: tempStart,
    end: tempEnd
  });
}
```

C) UI Dialog Komponenti ekle:
- ConflictDialog.tsx oluÅŸtur
- shadcn/ui AlertDialog kullan
- 3 buton: "Otomatik YerleÅŸtir", "DeÄŸiÅŸtir", "Ä°ptal"
- Ã–nerilen saati gÃ¶ster: "14:30-15:30 boÅŸ, oraya yerleÅŸtirelim mi?"

D) GÃ¶rsel feedback:
- onDragOver sÄ±rasÄ±nda Ã§akÄ±ÅŸma kontrolÃ¼ yap
- Ã‡akÄ±ÅŸan hÃ¼creye: className="bg-red-100 border-red-500"
- BoÅŸ hÃ¼crelere: className="bg-green-50 border-green-300"
- En yakÄ±n 3 hÃ¼creye: className="animate-pulse bg-blue-100"

--------------------------------------------------------------------------------
2. SPACED REPETITION (AKILLI TEKRAR) SÄ°STEMÄ°
--------------------------------------------------------------------------------

KOMUT:

TAKVÄ°M 2 (TopicPlanner) sistemine spaced repetition (aralÄ±klÄ± tekrar) algoritmasÄ± ekle:

TEORÄ°:
- Ä°lk Ã¶ÄŸrenme: Tam Ã¶ÄŸren
- 1 gÃ¼n sonra: %20 tekrar
- 3 gÃ¼n sonra: %15 tekrar  
- 7 gÃ¼n sonra: %10 tekrar
- 14 gÃ¼n sonra: %10 tekrar

VERÄ° YAPISI GÃœNCELLEMESÄ°:

1. TopicProgress interface'ine ekle:
```typescript
export type TopicProgress = {
  id: string;
  studentId: string;
  topicId: string;
  completed: number;
  remaining: number;
  completedFlag?: boolean;
  
  // YENÄ° ALANLAR:
  lastStudied?: string;           // Son Ã§alÄ±ÅŸma tarihi (ISO)
  masteryLevel?: number;          // 0-100 arasÄ± ustalÄ±k skoru
  reviewSchedule?: {              // Tekrar takvimi
    nextReviewDate: string;       // Bir sonraki tekrar tarihi
    reviewCount: number;          // KaÃ§ kez tekrar edildi
    reviewHistory: {              // Tekrar geÃ§miÅŸi
      date: string;
      duration: number;           // dakika
      quality: number;            // 1-5 arasÄ± kalite skoru
    }[];
  };
}
```

2. Database tablosunu gÃ¼ncelle:
```sql
ALTER TABLE progress ADD COLUMN lastStudied TEXT;
ALTER TABLE progress ADD COLUMN masteryLevel INTEGER DEFAULT 0;
ALTER TABLE progress ADD COLUMN reviewSchedule TEXT; -- JSON
```

PLANLAMA ALGORÄ°TMASI GÃœNCELLEMESÄ°:

1. planWeek fonksiyonunu gÃ¼ncelle:
```javascript
export async function planWeekWithReviews(
  studentId: string,
  weekStartISO: string
): Promise<PlannedEntry[]> {
  await ensureProgressForStudent(studentId);
  
  const slots = getWeeklySlotsByStudent(studentId);
  const progress = getProgressByStudent(studentId);
  const topics = loadTopics();
  
  // Tekrar edilmesi gereken konularÄ± bul
  const reviewsNeeded = findReviewsNeeded(progress, weekStartISO);
  
  // Normal plan + review planÄ±nÄ± birleÅŸtir
  const normalPlan = generateNormalPlan(slots, topics, progress);
  const reviewPlan = generateReviewPlan(slots, reviewsNeeded, weekStartISO);
  
  // Ã–ncelik: Reviewlar Ã¶nce
  return [...reviewPlan, ...normalPlan];
}

// Tekrar edilmesi gereken konularÄ± bul
function findReviewsNeeded(progress: TopicProgress[], weekStartISO: string) {
  const weekStart = new Date(weekStartISO);
  const weekEnd = new Date(weekStart.getTime() + 7 * 24 * 60 * 60 * 1000);
  
  return progress.filter(p => {
    if (!p.reviewSchedule || !p.completedFlag) return false;
    
    const nextReview = new Date(p.reviewSchedule.nextReviewDate);
    return nextReview >= weekStart && nextReview <= weekEnd;
  }).map(p => {
    const topic = loadTopics().find(t => t.id === p.topicId);
    const reviewDuration = calculateReviewDuration(p, topic);
    
    return {
      topicId: p.topicId,
      subjectId: topic.subjectId,
      duration: reviewDuration,
      priority: calculateReviewPriority(p),
      scheduledDate: p.reviewSchedule.nextReviewDate
    };
  }).sort((a, b) => b.priority - a.priority);
}

// Tekrar sÃ¼resi hesapla
function calculateReviewDuration(progress: TopicProgress, topic: Topic) {
  const reviewCount = progress.reviewSchedule?.reviewCount || 0;
  const baseMinutes = topic.avgMinutes;
  
  // Her tekrarda sÃ¼re azalÄ±r
  if (reviewCount === 0) return baseMinutes * 0.3;  // %30
  if (reviewCount === 1) return baseMinutes * 0.2;  // %20
  if (reviewCount === 2) return baseMinutes * 0.15; // %15
  return baseMinutes * 0.1; // %10
}

// Review Ã¶nceliÄŸi hesapla (gecikenler Ã¶nce)
function calculateReviewPriority(progress: TopicProgress) {
  const nextReview = new Date(progress.reviewSchedule.nextReviewDate);
  const today = new Date();
  const daysOverdue = Math.floor((today - nextReview) / (1000 * 60 * 60 * 24));
  
  return daysOverdue * 10 + (100 - progress.masteryLevel);
}
```

TEKRAR TAKVIMINI OTOMATIK OLUÅTUR:

```javascript
// Konu tamamlandÄ±ÄŸÄ±nda tekrar takvimi oluÅŸtur
export async function completeTopicAndScheduleReviews(
  studentId: string,
  topicId: string,
  quality: number // 1-5 arasÄ±
) {
  const progress = loadProgress().find(
    p => p.studentId === studentId && p.topicId === topicId
  );
  
  if (!progress) return;
  
  const today = new Date().toISOString().slice(0, 10);
  const reviewSchedule = generateReviewSchedule(today, quality);
  
  progress.completedFlag = true;
  progress.lastStudied = today;
  progress.masteryLevel = quality * 20; // 1->20, 5->100
  progress.reviewSchedule = reviewSchedule;
  
  await saveProgress([...loadProgress()]);
}

// Fibonacci benzeri aralÄ±klarla review schedule oluÅŸtur
function generateReviewSchedule(completionDate: string, quality: number) {
  const baseDate = new Date(completionDate);
  const intervals = quality >= 4 
    ? [1, 3, 7, 14, 30]      // YÃ¼ksek kalite: daha uzun aralÄ±k
    : [1, 2, 4, 7, 14, 21];  // DÃ¼ÅŸÃ¼k kalite: daha sÄ±k tekrar
  
  const schedule = intervals.map(days => {
    const reviewDate = new Date(baseDate);
    reviewDate.setDate(reviewDate.getDate() + days);
    return reviewDate.toISOString().slice(0, 10);
  });
  
  return {
    nextReviewDate: schedule[0],
    reviewCount: 0,
    reviewHistory: []
  };
}
```

UI GÃœNCELLEMELERÄ°:

1. Konu kartlarÄ±na review badge ekle:
```jsx
{progress.reviewSchedule?.nextReviewDate && (
  <Badge variant="outline" className="ml-2">
    ğŸ”„ Tekrar: {progress.reviewSchedule.nextReviewDate}
  </Badge>
)}
```

2. Plan gÃ¶rÃ¼nÃ¼mÃ¼nde review'larÄ± farklÄ± renklendir:
```jsx
// Normal konu: bg-primary/10
// Review konusu: bg-purple-100 border-purple-400
```

3. Kalite deÄŸerlendirme dialog'u ekle:
- Konu tamamlandÄ±ÄŸÄ±nda "Bu konuyu ne kadar iyi anladÄ±nÄ±z? 1-5" sor
- SeÃ§ime gÃ¶re review schedule oluÅŸtur

--------------------------------------------------------------------------------
3. AKILLI PLANLAMA (ZORLUK & Ã–NCELÄ°K BAZLI)
--------------------------------------------------------------------------------

KOMUT:

TAKVÄ°M 2'ye akÄ±llÄ± planlama algoritmasÄ± ekle. KonularÄ± sadece sÄ±raya gÃ¶re deÄŸil, zorluk ve Ã¶nceliÄŸe gÃ¶re yerleÅŸtir.

VERÄ° YAPISI:

1. Topic interface'ine ekle:
```typescript
export type StudyTopic = {
  id: string;
  subjectId: string;
  name: string;
  avgMinutes: number;
  order?: number;
  difficulty?: string;
  
  // YENÄ° ALANLAR:
  difficultyScore?: number;    // 1-10 arasÄ± zorluk
  priority?: number;           // 1-10 arasÄ± Ã¶ncelik
  deadline?: string;           // Son tarih (ISO)
  prerequisites?: string[];    // Ã–nkoÅŸul konu ID'leri
  energyLevel?: 'high' | 'medium' | 'low';  // Gereken enerji
}
```

2. WeeklySlot'a enerji bilgisi ekle:
```typescript
export type WeeklySlot = {
  // ... mevcut alanlar
  energyType?: 'high' | 'medium' | 'low';  // Bu saatteki enerji durumu
}
```

AKILLI SIRALAMA ALGORÄ°TMASI:

```javascript
// KonularÄ± akÄ±llÄ± sÄ±rala
function smartSortTopics(topics: StudyTopic[], progress: TopicProgress[]) {
  const today = new Date();
  
  return topics
    .map(topic => {
      const prog = progress.find(p => p.topicId === topic.id);
      
      // Skor hesaplama
      let score = 0;
      
      // 1. Deadline yakÄ±nsa +50 puan
      if (topic.deadline) {
        const daysUntil = Math.floor(
          (new Date(topic.deadline) - today) / (1000 * 60 * 60 * 24)
        );
        if (daysUntil <= 7) score += 50;
        else if (daysUntil <= 14) score += 30;
        else if (daysUntil <= 30) score += 10;
      }
      
      // 2. Ã–ncelik puanÄ±
      score += (topic.priority || 5) * 10;
      
      // 3. Zorluk puanÄ± (zorlar daha Ã¶nce)
      score += (topic.difficultyScore || 5) * 5;
      
      // 4. Kalan sÃ¼re fazlaysa +puan
      if (prog && prog.remaining > 120) score += 20;
      
      // 5. HiÃ§ baÅŸlanmamÄ±ÅŸsa +puan
      if (prog && prog.completed === 0) score += 15;
      
      return { ...topic, calculatedScore: score };
    })
    .sort((a, b) => b.calculatedScore - a.calculatedScore);
}

// SlotlarÄ± enerji seviyesine gÃ¶re sÄ±nÄ±flandÄ±r
function categorizeSlotsByEnergy(slots: WeeklySlot[]) {
  return slots.map(slot => {
    const hour = parseInt(slot.start.split(':')[0]);
    
    let energyType: 'high' | 'medium' | 'low';
    
    if (hour >= 8 && hour <= 11) {
      energyType = 'high';    // Sabah: YÃ¼ksek enerji
    } else if (hour >= 14 && hour <= 17) {
      energyType = 'medium';  // Ã–ÄŸleden sonra: Orta
    } else {
      energyType = 'low';     // AkÅŸam: DÃ¼ÅŸÃ¼k
    }
    
    return { ...slot, energyType };
  });
}

// Konu ile slot'u eÅŸleÅŸtir
function matchTopicToSlot(topic: StudyTopic, slot: WeeklySlot) {
  const topicEnergy = topic.energyLevel || 'medium';
  const slotEnergy = slot.energyType || 'medium';
  
  // Enerji eÅŸleÅŸme skoru
  const energyMatch = {
    'high-high': 10,
    'high-medium': 5,
    'high-low': 0,
    'medium-high': 7,
    'medium-medium': 10,
    'medium-low': 7,
    'low-high': 3,
    'low-medium': 7,
    'low-low': 10
  };
  
  return energyMatch[`${topicEnergy}-${slotEnergy}`] || 5;
}
```

PLANLAMA FONKSÄ°YONU GÃœNCELLEMESÄ°:

```javascript
export async function planWeekSmart(
  studentId: string,
  weekStartISO: string
): Promise<PlannedEntry[]> {
  await ensureProgressForStudent(studentId);
  
  const slots = categorizeSlotsByEnergy(
    getWeeklySlotsByStudent(studentId)
      .sort((a, b) => a.day - b.day || a.start.localeCompare(b.start))
  );
  
  const topics = loadTopics();
  const progress = getProgressByStudent(studentId);
  
  // Derslere gÃ¶re konularÄ± grupla ve akÄ±llÄ± sÄ±rala
  const topicsBySubject = new Map();
  
  for (const topic of topics) {
    const arr = topicsBySubject.get(topic.subjectId) || [];
    arr.push(topic);
    topicsBySubject.set(topic.subjectId, arr);
  }
  
  // Her dersin konularÄ±nÄ± akÄ±llÄ± sÄ±rala
  topicsBySubject.forEach((topicList, subjectId) => {
    const sorted = smartSortTopics(topicList, progress);
    topicsBySubject.set(subjectId, sorted);
  });
  
  const out: PlannedEntry[] = [];
  
  // Slotlara konularÄ± yerleÅŸtir
  for (const slot of slots) {
    const subjectTopics = topicsBySubject.get(slot.subjectId) || [];
    let remainingTime = minutesBetween(slot.start, slot.end);
    let currentMin = toMin(slot.start);
    
    while (remainingTime > 0 && subjectTopics.length > 0) {
      // En uygun konuyu bul
      const bestTopic = subjectTopics
        .filter(t => {
          const prog = progress.find(p => p.topicId === t.id);
          return prog && !prog.completedFlag && prog.remaining > 0;
        })
        .map(t => ({
          topic: t,
          matchScore: matchTopicToSlot(t, slot)
        }))
        .sort((a, b) => b.matchScore - a.matchScore)[0];
      
      if (!bestTopic) break;
      
      const topic = bestTopic.topic;
      const prog = progress.find(p => p.topicId === topic.id)!;
      const allocated = Math.min(remainingTime, prog.remaining);
      
      out.push({
        date: dateFromWeekStart(weekStartISO, slot.day),
        start: fmt(currentMin),
        end: fmt(currentMin + allocated),
        subjectId: slot.subjectId,
        topicId: topic.id,
        allocated,
        remainingAfter: prog.remaining - allocated,
        energyMatch: bestTopic.matchScore  // Ekstra bilgi
      });
      
      prog.remaining -= allocated;
      if (prog.remaining <= 0) prog.completedFlag = true;
      
      remainingTime -= allocated;
      currentMin += allocated;
    }
  }
  
  return out;
}
```

UI Ä°YÄ°LEÅTÄ°RMELERÄ°:

1. Konu kartlarÄ±na deadline badge:
```jsx
{topic.deadline && (
  <Badge variant={daysUntil <= 7 ? "destructive" : "secondary"}>
    ğŸ“… {topic.deadline}
  </Badge>
)}
```

2. Enerji gÃ¶stergesi:
```jsx
{energyMatch >= 8 ? "âš¡ MÃ¼kemmel eÅŸleÅŸme" : 
 energyMatch >= 5 ? "âœ“ Uygun" : 
 "âš ï¸ Az uyumlu"}
```

3. Zorluk gÃ¶stergesi:
```jsx
<div className="flex gap-1">
  {Array.from({length: topic.difficultyScore || 5}).map((_, i) => (
    <div key={i} className="w-2 h-4 bg-red-500 rounded" />
  ))}
</div>
```

--------------------------------------------------------------------------------
4. UNDO/REDO SÄ°STEMÄ°
--------------------------------------------------------------------------------

KOMUT:

TAKVÄ°M 1'e undo/redo (geri al/tekrarla) Ã¶zelliÄŸi ekle.

GLOBAL STATE YÃ–NETÄ°MÄ°:

1. useUndo custom hook oluÅŸtur:
```typescript
// client/hooks/useUndo.ts
import { useState, useCallback } from 'react';

type HistoryEntry<T> = {
  state: T;
  timestamp: number;
  action: string;  // "add", "remove", "update", "resize", "move"
};

export function useUndo<T>(
  initialState: T,
  maxHistory: number = 20
) {
  const [history, setHistory] = useState<HistoryEntry<T>[]>([
    { state: initialState, timestamp: Date.now(), action: 'init' }
  ]);
  const [currentIndex, setCurrentIndex] = useState(0);
  
  const currentState = history[currentIndex]?.state || initialState;
  
  const push = useCallback((newState: T, action: string) => {
    setHistory(prev => {
      const newHistory = prev.slice(0, currentIndex + 1);
      newHistory.push({
        state: newState,
        timestamp: Date.now(),
        action
      });
      
      // Max history sÄ±nÄ±rÄ±
      if (newHistory.length > maxHistory) {
        newHistory.shift();
        return newHistory;
      }
      
      return newHistory;
    });
    setCurrentIndex(prev => prev + 1);
  }, [currentIndex, maxHistory]);
  
  const undo = useCallback(() => {
    if (currentIndex > 0) {
      setCurrentIndex(prev => prev - 1);
      return history[currentIndex - 1].state;
    }
    return currentState;
  }, [currentIndex, history, currentState]);
  
  const redo = useCallback(() => {
    if (currentIndex < history.length - 1) {
      setCurrentIndex(prev => prev + 1);
      return history[currentIndex + 1].state;
    }
    return currentState;
  }, [currentIndex, history, currentState]);
  
  const canUndo = currentIndex > 0;
  const canRedo = currentIndex < history.length - 1;
  
  return {
    state: currentState,
    push,
    undo,
    redo,
    canUndo,
    canRedo,
    history: history.slice(0, currentIndex + 1)
  };
}
```

2. WeeklySchedule'a entegre et:
```typescript
export default function WeeklySchedule({ sid }: { sid: string }) {
  const [subjects, setSubjects] = useState([]);
  
  // Undo/Redo state
  const {
    state: slots,
    push: pushHistory,
    undo,
    redo,
    canUndo,
    canRedo,
    history
  } = useUndo<WeeklySlot[]>([], 30);
  
  // Slots deÄŸiÅŸtiÄŸinde API'ye kaydet
  useEffect(() => {
    if (slots.length > 0) {
      saveWeeklySlots(slots).catch(console.error);
    }
  }, [slots]);
  
  // Ä°lk yÃ¼kleme
  useEffect(() => {
    const initialSlots = getWeeklySlotsByStudent(sid);
    if (initialSlots.length > 0) {
      pushHistory(initialSlots, 'load');
    }
  }, [sid]);
  
  // Ders ekleme
  const addSlot = (slot: WeeklySlot) => {
    const newSlots = [...slots, slot];
    pushHistory(newSlots, 'add');
    addWeeklySlot(slot);  // API call
  };
  
  // Ders silme
  const removeSlot = (id: string) => {
    const newSlots = slots.filter(s => s.id !== id);
    pushHistory(newSlots, 'remove');
    removeWeeklySlot(id);  // API call
  };
  
  // Ders gÃ¼ncelleme
  const updateSlot = (id: string, patch: Partial<WeeklySlot>) => {
    const newSlots = slots.map(s => 
      s.id === id ? { ...s, ...patch } : s
    );
    pushHistory(newSlots, 'update');
    updateWeeklySlot(id, patch);  // API call
  };
  
  // Keyboard shortcuts
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if ((e.ctrlKey || e.metaKey) && e.key === 'z' && !e.shiftKey) {
        e.preventDefault();
        if (canUndo) {
          const prevState = undo();
          saveWeeklySlots(prevState);
        }
      } else if ((e.ctrlKey || e.metaKey) && (e.key === 'y' || (e.key === 'z' && e.shiftKey))) {
        e.preventDefault();
        if (canRedo) {
          const nextState = redo();
          saveWeeklySlots(nextState);
        }
      }
    };
    
    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [undo, redo, canUndo, canRedo]);
  
  return (
    <Card>
      <CardHeader>
        <div className="flex items-center justify-between">
          <div>
            <CardTitle>HaftalÄ±k Ders Ã‡izelgesi</CardTitle>
            <CardDescription>
              Takvim 1 â€” Ãœstten dersi sÃ¼rÃ¼kleyip gÃ¼n/saat alanÄ±na bÄ±rakÄ±n
            </CardDescription>
          </div>
          
          {/* Undo/Redo Buttons */}
          <div className="flex gap-2">
            <Button
              variant="outline"
              size="sm"
              onClick={() => {
                const prevState = undo();
                saveWeeklySlots(prevState);
              }}
              disabled={!canUndo}
              title="Geri Al (Ctrl+Z)"
            >
              <Undo2 className="h-4 w-4" />
            </Button>
            <Button
              variant="outline"
              size="sm"
              onClick={() => {
                const nextState = redo();
                saveWeeklySlots(nextState);
              }}
              disabled={!canRedo}
              title="Tekrarla (Ctrl+Y)"
            >
              <Redo2 className="h-4 w-4" />
            </Button>
            
            {/* History Dropdown */}
            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <Button variant="outline" size="sm">
                  <History className="h-4 w-4" />
                </Button>
              </DropdownMenuTrigger>
              <DropdownMenuContent align="end" className="w-64">
                <DropdownMenuLabel>Ä°ÅŸlem GeÃ§miÅŸi</DropdownMenuLabel>
                <DropdownMenuSeparator />
                {history.slice().reverse().map((entry, i) => (
                  <DropdownMenuItem key={i}>
                    <span className="text-xs text-muted-foreground">
                      {formatActionName(entry.action)} - {formatTime(entry.timestamp)}
                    </span>
                  </DropdownMenuItem>
                ))}
              </DropdownMenuContent>
            </DropdownMenu>
          </div>
        </div>
      </CardHeader>
      {/* ... rest of component */}
    </Card>
  );
}

// Helper fonksiyonlar
function formatActionName(action: string) {
  const names = {
    add: 'â• Ders eklendi',
    remove: 'ğŸ—‘ï¸ Ders silindi',
    update: 'âœï¸ Ders gÃ¼ncellendi',
    resize: 'â†”ï¸ Boyut deÄŸiÅŸtirildi',
    move: 'â†—ï¸ Ders taÅŸÄ±ndÄ±',
    load: 'ğŸ“‚ YÃ¼klendi'
  };
  return names[action] || action;
}

function formatTime(timestamp: number) {
  return new Date(timestamp).toLocaleTimeString('tr-TR', {
    hour: '2-digit',
    minute: '2-digit'
  });
}
```

GEREKLI Ä°KONLAR:
```typescript
import { Undo2, Redo2, History } from "lucide-react";
```

TOAST BÄ°LDÄ°RÄ°MLERÄ°:
```typescript
// Undo yapÄ±ldÄ±ÄŸÄ±nda
toast.info("Son iÅŸlem geri alÄ±ndÄ±", {
  action: {
    label: "Tekrarla",
    onClick: () => redo()
  }
});
```

--------------------------------------------------------------------------------
5. TEMPLATE (ÅABLON) SÄ°STEMÄ°
--------------------------------------------------------------------------------

KOMUT:

HazÄ±r program ÅŸablonlarÄ± sistemi ekle: "LGS HazÄ±rlÄ±k", "YKS Son 3 Ay", "TYT YoÄŸun" gibi.

VERÄ° YAPISI:

```typescript
export type ScheduleTemplate = {
  id: string;
  name: string;
  description: string;
  category: 'LGS' | 'YKS' | 'TYT' | 'AYT' | 'Custom';
  slots: Omit<WeeklySlot, 'id' | 'studentId'>[];
  subjects: {
    id: string;
    name: string;
    category: string;
  }[];
  estimatedWeeklyHours: number;
  difficulty: 'Kolay' | 'Orta' | 'YoÄŸun' | 'Ã‡ok YoÄŸun';
  tags: string[];
};
```

Ã–RNEK ÅABLONLAR:

```typescript
const TEMPLATES: ScheduleTemplate[] = [
  {
    id: 'lgs-balanced',
    name: 'LGS Dengeli Program',
    description: 'Hafta iÃ§i gÃ¼nde 3 saat, hafta sonu 4 saat Ã§alÄ±ÅŸma',
    category: 'LGS',
    estimatedWeeklyHours: 23,
    difficulty: 'Orta',
    tags: ['lgs', 'dengeli', '8.sÄ±nÄ±f'],
    subjects: [
      { id: 'mat-lgs', name: 'Matematik', category: 'LGS' },
      { id: 'fen-lgs', name: 'Fen Bilimleri', category: 'LGS' },
      { id: 'tur-lgs', name: 'TÃ¼rkÃ§e', category: 'LGS' },
      { id: 'sos-lgs', name: 'Sosyal Bilgiler', category: 'LGS' },
      { id: 'ing-lgs', name: 'Ä°ngilizce', category: 'LGS' },
      { id: 'din-lgs', name: 'Din KÃ¼ltÃ¼rÃ¼', category: 'LGS' }
    ],
    slots: [
      // Pazartesi
      { day: 1, start: '17:00', end: '18:30', subjectId: 'mat-lgs' },
      { day: 1, start: '19:00', end: '20:00', subjectId: 'tur-lgs' },
      // SalÄ±
      { day: 2, start: '17:00', end: '18:30', subjectId: 'fen-lgs' },
      { day: 2, start: '19:00', end: '20:00', subjectId: 'ing-lgs' },
      // Ã‡arÅŸamba
      { day: 3, start: '17:00', end: '18:30', subjectId: 'mat-lgs' },
      { day: 3, start: '19:00', end: '20:00', subjectId: 'sos-lgs' },
      // PerÅŸembe
      { day: 4, start: '17:00', end: '18:30', subjectId: 'fen-lgs' },
      { day: 4, start: '19:00', end: '20:00', subjectId: 'din-lgs' },
      // Cuma
      { day: 5, start: '17:00', end: '18:30', subjectId: 'mat-lgs' },
      { day: 5, start: '19:00', end: '20:00', subjectId: 'tur-lgs' },
      // Cumartesi
      { day: 6, start: '10:00', end: '12:00', subjectId: 'mat-lgs' },
      { day: 6, start: '14:00', end: '16:00', subjectId: 'fen-lgs' },
      // Pazar
      { day: 7, start: '10:00', end: '12:00', subjectId: 'sos-lgs' },
      { day: 7, start: '14:00', end: '16:00', subjectId: 'deneme-sinavi' }
    ]
  }
];
```

UI KOMPONENTÄ°:

KullanÄ±cÄ±ya ÅŸablon seÃ§imi iÃ§in dialog gÃ¶ster, uygulama butonuyla mevcut programa dersleri ve slotlarÄ± ekle.

================================================================================
SON
================================================================================

Bu dosya, takvim sisteminin tam dokÃ¼mantasyonunu ve geliÅŸtirilmesi gereken 
Ã¶zellikleri iÃ§ermektedir. Her komut bloÄŸu direkt olarak yapay zekaya 
verilebilir durumda hazÄ±rlanmÄ±ÅŸtÄ±r.
